---
title: 极大似然函数简单解释
date: 2018-06-11 20:15:26
tags:
    - 极大似然
categories: 人工智能
mathjax: true
---

极大似然函数花了我好多时间理解。我觉得很有必要写一篇博文解释一下。虽然网上有关的博客很多，但大多数都写得过于复杂，我想解释得简单一些。

## 举栗子是最好的方法

[如何理解似然函数? - 陈琳的回答 - 知乎]( https://www.zhihu.com/question/54082000/answer/137868083)

引用知乎上这位朋友的回答，再扩展一下。

我也假设有一个特殊的骰子，不知道有多少面。我们知道一般骰子都是6面，但我这里的骰子面数未知，是特制的。现在我们拿这个骰子抛了1000次，其中我们发现其中“1”的这一面出现了100次。当然按照直觉我们认为这个骰子最有可能是10个面，但是怎么用数学证明出来呢？如果我们经过大量的实验知道了某件事情的结果，想要反过来推测这件事情发生的概率，那么这个推测就称为极大似然估计。

设这个骰子有N面，所以出现“1”面的概率就是${1 \over N}$。根据联合概率计算公式，发生1000次抛骰子而有100次某个面向上这个结果的概率为：
$$
P=({1 \over N})^{100}  (1-{1\over N})^{900}
$$
那么，怎么求出N呢？所谓最大似然，是指N最有可能是什么。在这个函数里面，最有可能是不是说对函数P求导，只要求出导数为0那个N值就可以了？当导数为0时我们可以求出P的极值点。即，我们要求P的导数$P'$为0的情况。

但是，上面那个式子的导数不好求啊，900次方了都。但是，数学家们很聪明，他们发现对幂数函数取对数不会改变函数的单调性。设$y=f(x)$，那么，$ln(f(x))$的单调性与$f(x)$的单调性一样。即：$f'(x)$与$(ln(f(x)))'$的极值点是一样的。

于是，我们对P取对数：
$$
ln(P)=ln(({1 \over N})^{100}  (1-{1\over N})^{900})=100ln{1\over N}+900ln(1-{1\over N})
$$
对数公式就不解释啦，这个可以百度。对数真是一个神奇的东西，可以把这么复杂的幂函数化简成这个样子。补充数学公式：

> 1. $ln(ab)=lna+lnb$
>
> 2. $ln(a^b)=blna$
>
> 3. $(lnx)'={1\over x}$
>
> 4. $(x^n)'=nx^{n-1}$
>
> 5. 复合函数$f(g(x))$的导数为：
>    $$
>    f'(g(x))=g'(x)*f'(g(x))
>    $$
>

所以：
$$
(ln(P))'=(100ln{1\over N}+900ln(1-{1\over N}))'=100*N*-1*{1\over N^2}+900*{N\over {N-1}}*{1\over N^2}
$$

$$
(ln(P))'=900({1\over {N(N-1)}})-100{1\over N}
$$

令$(ln(P))'=0$，得：
$$
900({1\over {N(N-1)}})=100{1\over N}
$$
即：
$$
900{1\over{N-1}}=100
$$
这是初中的方程哦，我们可以得出：
$$
N=10
$$
所以，这个骰子最有可能有10个面。问题得解。



