---
title: 新立项开发方案讨论
date: 2018-06-20 18:28:12
tags:
    - 方案讨论
categories: 架构方案
---

### 文档说明

#### 文档目标

本文档针对新立项的开发需求，讨论开发模式与建表技术方案。本文档具有文档作者的某些倾向性认同方案。希望其他同事不受文档作者倾向性的影响，提出不同的意见，便于制订最佳方案。

#### 文档信息

| 文档作者 | 更新日期 | 更新信息 | 备注 |
| :--------: | :--------: |:-------- | :---- |
|   李清泉       |   2018-06-16       |     新文档撰写     |  本方案是草稿方案    |

### 建表方案讨论

新的立项与云南立项的字段大同小异，这里有两种建表方式：

> 1. 在原有立项表结构基础上，增加一些字段。
> 2. 全新建表。

下面详细论述这两套方案的优缺点。

#### 在原有立项表结构基础建表

广东的立项的表单与原来云南立项的表单大同小异。我们当然可以共用原来的表结构，在原来的基础上做一些拓展。

##### 优点

1. 减少数据库的复杂度。这样建表的目标是在业务上我们将广东的立项跟原来的立项不做区分，我们认为广东的立项只是原来业务基础上新增加的需求。模块是一样的。
2. 方便做统计功能。如果采用两套不同的表，做统计时只能使用union all的方式，SQL语句比较复杂。

##### 缺点

1. 必须修改原来的代码逻辑，风险高。
2. 业务逻辑耦合度高，区分复杂，不利于以后的业务扩展。
3. 不利于新员工学习理解。

#### 全新建表

全新建表，就是这次的广东立项需求我们建一套完全全新的表体系，数据跟之前的数据完全不混合。

##### 优点

1. 代码、业务耦合度低。我们可以将这次的需求理解成为一个全新的业务模块，完全不受之前立项模块的影响，从新写代码。
2. 不需要对原来模块的代码做任何修改，风险低。
3. 以后如果有立项的需求，可以完全按现有的方式开发，扩展性强。
4. 有利于新员工的学习。业务、代码的耦合会让新人理解起来麻烦。
5. 不同地区的数据分开存储，性能有一定提升。

##### 缺点

1. 表的数量多，增加数据库复杂度。
2. 增加建表工作量。
3. 做统计功能时，如果涉及到所有立项的数据，必须使用union 语句，SQL语句复杂度高。

### 开发模式讨论

新立项的开发模式和设计上，有两种方案可以选择：

> 1. 使用微服务模式。
> 2. 在双创现有代码上，增加一个模块。

下面讨论一下这两种方案的区别和优缺点。

#### 微服务开发模式

微服务的开发模块就是我们按照新框架的开发规范，新增加一个微服务，在这个微服务模块上开发新的广东立项的逻辑。

##### 优点

1. 给我们开发人员实践新框架的机会，加快开发人员熟悉新框架开发规范。
2. 完全体现了新框架的优势：扩展性强，可维护性强，代码耦合度低。
3. 有利于新员工理解。
4. 运维方便。广东立项版本发布不受大版本旧系统的影响。

##### 缺点

1. 新框架的开发模式还没有在开发人员身上理解深刻，上线新框架的开发模式有些仓促。
2. 搭建框架需要一定的时间，有风险。
3. 正式环境还没有准备好全面新框架的上线条件，存在风险。
4. 客户还没有同意这种全新的部署方式。
5. 需要跟进硬件资源。
6. 运维人员还没有熟悉新框架的运维方式，需要他们有熟悉的过程。存在一定风险因素。

#### 原有系统新增模块

原有双创项目上新增模块，就是按照以前的开发模式，采用保守的方法，新增一个代码模块进行开发。

##### 优点

1. 按照大家熟悉的模式进行开发，风险低。
2. 框架没有发生改变，旧的标签都可以一样使用，不需要另外产生开发工作量。
3. 不产生接口工作量。
4. 不需要考虑客户部署申请等工作要求。

##### 缺点

1. 该方案过于保守。即使在新框架开发接近可使用的基础上，仍然使用原有的开发模式。
2. 不利于开发人员熟悉新框架的开发模式。损失了一次锻炼的机会。
3. 不能体现出新框架的优势。

#### 考虑方式

1. 对风险的评估。特别是对开发时间的评估，采用微服务的开发模式的工作量要超过采用增加新模块的开发模式。但不会超过很多。
2. 广东立项模块的重要程度。
3. 如果采用新框架微服务的开发模式，要求事先有合理的风险回避方案。

### 采用微服务开发模式的风险回避方案

采用新框架的开发模式，会产生更高的风险，我认为可以考虑以下的点：

> 1. 对新框架开发模式工作量和大家的适应时间应作出合理的评估
> 2. 在采用微服务开发模式的情况下，如果出现风险，应该如何解决？
> 3. 结合两种开发模式回避风险

#### 作出合理的评估

大家应充分发表意见。充分列出可能产生风险的地方，以方便大家对可能出现的问题有合理的预防和评估。

#### 有合理的回避风险的方法

比如以下的方法有助于解决困境：

1. 如果三天新框架不能正常跑起来，应放弃采用新框架的开发模式，回归原来的开发模式。
2. 大家不能适应新框架开发模式时，应回归原来的开发模式。
3. 大家发现新框架的开发模式明显增加工作量且无法解决，影响到新版本发布时，应该放弃这种开发模式。

#### 结合两种开发模式

我认为两种开发模式并不是完全冲突且不能有任何兼容的。以下方法是回避风险的有效方法：

1. 在搭建新的微服务模块的同时，其他开发人员可以在原有的系统上新增模块采用原有的模式写代码。
2. 新框架如果可以顺利搭建，将代码从旧系统上复制过来并按照新框架模式进行开发。
3. 同样，采用新模式遇到不可解决的风险时，也可以将业务代码复制到原有的系统继续开发。
4. 开发模块，大家应注意尽量不要耦合其他模块的业务代码，造成分割困难。

